"use strict";(self.webpackChunkdominus=self.webpackChunkdominus||[]).push([[974],{5974:(ae,f,u)=>{u.r(f),u.d(f,{AdminProductModule:()=>de});var a=u(177),d=u(9417),p=u(3756),e=u(540),g=u(7359),m=u(5423),h=u(2565);function _(i,l){1&i&&(e.j41(0,"div",33),e.nrm(1,"div",34),e.k0s())}const F=function(i,l,t){return{"text-green-600":i,"text-orange-600":l,"text-red-600":t}};function x(i,l){if(1&i){const t=e.RV6();e.j41(0,"tr",43)(1,"td",44),e.EFF(2),e.k0s(),e.j41(3,"td",45)(4,"div",46)(5,"div",47),e.nrm(6,"img",48),e.k0s(),e.j41(7,"div")(8,"div",49),e.EFF(9),e.k0s(),e.j41(10,"div",50),e.EFF(11),e.j41(12,"span"),e.EFF(13),e.k0s()()()()(),e.j41(14,"td",51),e.EFF(15),e.k0s(),e.j41(16,"td",44)(17,"span",52),e.EFF(18),e.k0s()(),e.j41(19,"td",44)(20,"span",53),e.EFF(21),e.k0s()(),e.j41(22,"td",44)(23,"span",53),e.EFF(24),e.k0s()(),e.j41(25,"td",44)(26,"span",53),e.EFF(27),e.k0s()(),e.j41(28,"td",44)(29,"span",53),e.EFF(30),e.k0s()(),e.j41(31,"td",44)(32,"span",53),e.EFF(33),e.k0s()(),e.j41(34,"td",54)(35,"div",55)(36,"button",56),e.bIt("click",function(){const s=e.eBV(t).$implicit,n=e.XpG(2);return e.Njj(n.openModal("edit",s))}),e.nrm(37,"i",57),e.k0s(),e.j41(38,"button",58),e.bIt("click",function(){const s=e.eBV(t).$implicit,n=e.XpG(2);return e.Njj(n.openModal("delete",s))}),e.nrm(39,"i",59),e.k0s()()()()}if(2&i){const t=l.$implicit,r=l.index;e.R7$(2),e.JRh(r+1),e.R7$(4),e.Y8G("src",null==t.images?null:t.images[0],e.B4B)("alt",t.name),e.R7$(3),e.JRh(t.name),e.R7$(2),e.SpI("id: ",t.id," - "),e.R7$(1),e.xc7("color",t.isActive?"green":"red"),e.R7$(1),e.SpI(" ",t.isActive?"Active":"Deactive"," "),e.R7$(2),e.SpI(" $",t.price," "),e.R7$(2),e.Y8G("ngClass",e.sMw(16,F,t.currentStock>10,t.currentStock<=10&&t.currentStock>0,0===t.currentStock)),e.R7$(1),e.SpI(" ",t.currentStock," "),e.R7$(3),e.SpI(" ",t.categoryName," "),e.R7$(3),e.SpI(" ",t.availableColors," "),e.R7$(3),e.SpI(" ",t.warranty," "),e.R7$(3),e.SpI(" ",t.isActive?"Yes":"No"," "),e.R7$(3),e.SpI(" ",t.topSelling?"Yes":"No"," ")}}function k(i,l){1&i&&(e.j41(0,"div",60),e.nrm(1,"i",61),e.j41(2,"h3",62),e.EFF(3,"No products found"),e.k0s(),e.j41(4,"p",63),e.EFF(5,"Get started by adding your first product."),e.k0s(),e.j41(6,"button",64),e.EFF(7," Add Product "),e.k0s()())}function C(i,l){if(1&i&&(e.j41(0,"div",35)(1,"div",36)(2,"table",37)(3,"thead",38)(4,"tr")(5,"th",39),e.EFF(6,"Index"),e.k0s(),e.j41(7,"th",39),e.EFF(8,"Product Name"),e.k0s(),e.j41(9,"th",39),e.EFF(10,"Price"),e.k0s(),e.j41(11,"th",39),e.EFF(12,"Stock"),e.k0s(),e.j41(13,"th",39),e.EFF(14,"Category"),e.k0s(),e.j41(15,"th",39),e.EFF(16,"Colors"),e.k0s(),e.j41(17,"th",39),e.EFF(18,"Warranty"),e.k0s(),e.j41(19,"th",39),e.EFF(20,"Active"),e.k0s(),e.j41(21,"th",39),e.EFF(22,"Hot"),e.k0s(),e.j41(23,"th",39),e.EFF(24,"Actions"),e.k0s()()(),e.j41(25,"tbody",40),e.DNE(26,x,40,20,"tr",41),e.k0s()()(),e.DNE(27,k,8,0,"div",42),e.k0s()),2&i){const t=e.XpG();e.R7$(26),e.Y8G("ngForOf",t.filteredProducts),e.R7$(1),e.Y8G("ngIf",0===t.filteredProducts.length)}}let y=(()=>{class i{constructor(t,r){this.productService=t,this.toast=r,this.products=[],this.activeProductsCount=0,this.lowStockCount=0,this.filteredProducts=[],this.isLoading=!1,this.searchTerm="",this.outOfStockCount=0,this.isEditModalOpen=!1,this.isDeleteModalOpen=!1,this.selectedProduct=null,this.isModalOpen=!1,this.modalMode="edit"}ngOnInit(){console.log("AdminProductlistComponent initialized"),this.getProducts()}getProducts(){this.isLoading=!0,this.productService.getAllProducts().subscribe({next:t=>{this.products=t,this.filteredProducts=t,console.log(this.filteredProducts),console.log(this.products),this.calculateCounts()},error:t=>{console.error("Error loading products:",t)},complete:()=>{this.isLoading=!1}})}filterProducts(){const t=this.searchTerm.trim();t?this.productService.searchProducts(t).subscribe({next:r=>{console.log("RAW SEARCH RESPONSE:",r),this.filteredProducts=r?.data?.items?r.data.items:[],console.log("FILTERED PRODUCTS:",this.filteredProducts)},error:r=>console.error("Search failed",r)}):this.filteredProducts=this.products}calculateCounts(){this.activeProductsCount=this.products.filter(t=>t.isActive).length,this.lowStockCount=this.products.filter(t=>t.currentStock>=0&&t.currentStock<=10).length,this.outOfStockCount=this.products.filter(t=>0===t.currentStock).length}openModal(t,r){this.selectedProduct=r,this.modalMode=t,this.isModalOpen=!0}closeModal(){this.isModalOpen=!1,this.selectedProduct=null}handleSave(t){if(!this.selectedProduct)return;const r={id:this.selectedProduct.id,name:t.name,description:t.description||"",price:Number(t.price),currentStock:Number(t.currentStock),categoryId:Number(t.category??t.categoryId),isActive:!!t.isActive,status:!!t.status,topSelling:!!t.topSelling,warranty:t.warranty||"",colorIds:(t.colorIds||[]).map(o=>Number(o)),files:t.files||[]};console.log("UPDATE PAYLOAD",r),this.productService.updateProduct(r).subscribe({next:()=>{this.closeModal(),this.getProducts(),this.toast.success("Product updated successfully")},error:o=>{console.error("Update error",o),this.toast.error(o?.error?.message||o?.message||"Update failed")}})}handleDelete(t){this.productService.deleteProduct(t).subscribe({next:()=>{this.toast.success("Product deleted"),this.closeModal(),this.getProducts()},error:()=>this.toast.error("Delete failed")})}static{this.\u0275fac=function(r){return new(r||i)(e.rXU(g.b),e.rXU(m.f))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-admin-productlist"]],decls:60,vars:13,consts:[[1,"bg-yellow-100","border-l-4","border-green-500","p-3","mb-2"],[1,"flex"],[1,"flex-shrink-0"],[1,"fa-solid","fa-bug","text-green-500"],[1,"ml-3"],[1,"text-sm","text-yellow-700"],[1,"mx-auto","pt-4"],[1,"flex","justify-between","items-center","mb-3"],[1,"text-2xl","font-bold","text-gray-800"],["routerLink","/admin/products/new",1,"bg-blue-600","hover:bg-blue-700","text-white","px-4","py-2","rounded-lg","flex","items-center","space-x-2","transition-colors"],[1,"fa-solid","fa-plus"],[1,"mt-4","grid","grid-cols-1","sm:grid-cols-2","md:grid-cols-4","gap-3"],[1,"bg-white","rounded-xl","border","border-green-500","p-3","flex","items-center","space-x-3"],[1,"text-blue-500","text-lg"],[1,"fa-solid","fa-cube"],[1,"text-xs","text-gray-500","font-medium"],[1,"text-lg","font-semibold","text-gray-900"],[1,"text-green-500","text-lg"],[1,"fa-solid","fa-check-circle"],[1,"text-orange-500","text-lg"],[1,"fa-solid","fa-exclamation-triangle"],[1,"text-red-500","text-lg"],[1,"fa-solid","fa-times-circle"],[1,"bg-white","rounded-lg","border","border-gray-200","p-4","mb-4"],[1,"flex","flex-col","sm:flex-row","gap-3","items-center","justify-between"],[1,"relative","flex-1","w-full"],[1,"absolute","inset-y-0","left-0","pl-3","flex","items-center","pointer-events-none"],[1,"fa-solid","fa-search","text-gray-400"],["type","text","placeholder","Search products by name, category, or ID...",1,"pl-10","text-black","pr-4","py-2","w-full","border","border-gray-300","rounded-lg","focus:border-blue-500","transition-colors",3,"ngModel","ngModelChange","input"],[1,"flex","items-center","space-x-2","text-sm","text-gray-500"],["class","flex justify-center py-10",4,"ngIf"],["class","bg-white rounded-lg overflow-hidden pt-4",4,"ngIf"],[3,"isOpen","mode","entityType","product","close","save","confirmDelete"],[1,"flex","justify-center","py-10"],[1,"w-10","h-10","border-4","border-blue-500","border-t-transparent","rounded-full","animate-spin"],[1,"bg-white","rounded-lg","overflow-hidden","pt-4"],[1,"overflow-x-auto"],[1,"min-w-full","divide-y","divide-grey"],[1,"bg-gray-50"],[1,"px-2","py-3","text-left","text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],[1,"bg-white","divide-y","divide-gray-200"],["class","hover:bg-gray-50 transition-colors",4,"ngFor","ngForOf"],["class","text-center py-12",4,"ngIf"],[1,"hover:bg-gray-50","transition-colors"],[1,"px-2","py-3","whitespace-nowrap","text-sm","text-gray-500"],[1,"px-2","py-3","whitespace-nowrap"],[1,"flex","items-center"],[1,"flex-shrink-0","h-10","w-10","bg-gray-200","rounded-lg","flex","items-center","justify-center","mr-3"],[1,"w-full","h-full","object-cover","group-hover:scale-110","transition-transform","duration-500","rounded-lg",3,"src","alt"],[1,"text-sm","font-medium","text-gray-900"],[1,"text-sm","text-gray-500"],[1,"px-2","py-3","whitespace-nowrap","text-sm","font-medium","text-gray-900"],[3,"ngClass"],[1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium","bg-blue-100","text-blue-800"],[1,"px-2","py-3","whitespace-nowrap","text-sm","font-medium"],[1,"flex","space-x-2"],[1,"text-blue-600","hover:text-blue-900","transition-colors","flex","items-center","space-x-1",3,"click"],[1,"fa-solid","fa-edit","w-4"],[1,"text-red-600","hover:text-red-900","transition-colors","flex","items-center","space-x-1",3,"click"],[1,"fa-solid","fa-trash","w-4"],[1,"text-center","py-12"],[1,"fa-solid","fa-box-open","text-4xl","text-gray-300","mb-4"],[1,"text-lg","font-medium","text-gray-700","mb-2"],[1,"text-gray-500","mb-6"],["routerLink","/admin/products/new",1,"bg-blue-600","hover:bg-blue-700","text-white","px-6","py-2","rounded-lg","transition-colors"]],template:function(r,o){1&r&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2),e.nrm(3,"i",3),e.k0s(),e.j41(4,"div",4)(5,"p",5),e.EFF(6," Success: Product List Component Loaded Successfully! "),e.k0s()()()(),e.j41(7,"div",6)(8,"div",7)(9,"h1",8),e.EFF(10,"Product List"),e.k0s(),e.j41(11,"button",9),e.nrm(12,"i",10),e.j41(13,"span"),e.EFF(14,"Add Product"),e.k0s()()(),e.j41(15,"div",11)(16,"div",12)(17,"div",13),e.nrm(18,"i",14),e.k0s(),e.j41(19,"div")(20,"p",15),e.EFF(21,"Total Products"),e.k0s(),e.j41(22,"p",16),e.EFF(23),e.k0s()()(),e.j41(24,"div",12)(25,"div",17),e.nrm(26,"i",18),e.k0s(),e.j41(27,"div")(28,"p",15),e.EFF(29,"Active Products"),e.k0s(),e.j41(30,"p",16),e.EFF(31),e.k0s()()(),e.j41(32,"div",12)(33,"div",19),e.nrm(34,"i",20),e.k0s(),e.j41(35,"div")(36,"p",15),e.EFF(37,"Low Stock"),e.k0s(),e.j41(38,"p",16),e.EFF(39),e.k0s()()(),e.j41(40,"div",12)(41,"div",21),e.nrm(42,"i",22),e.k0s(),e.j41(43,"div")(44,"p",15),e.EFF(45,"Out of Stock"),e.k0s(),e.j41(46,"p",16),e.EFF(47),e.k0s()()()(),e.j41(48,"div",23)(49,"div",24)(50,"div",25)(51,"div",26),e.nrm(52,"i",27),e.k0s(),e.j41(53,"input",28),e.bIt("ngModelChange",function(n){return o.searchTerm=n})("input",function(){return o.filterProducts()}),e.k0s()(),e.j41(54,"div",29)(55,"span"),e.EFF(56),e.k0s()()()(),e.DNE(57,_,2,0,"div",30),e.DNE(58,C,28,2,"div",31),e.j41(59,"app-admin-modals",32),e.bIt("close",function(){return o.closeModal()})("save",function(n){return o.handleSave(n)})("confirmDelete",function(n){return o.handleDelete(n)}),e.k0s()()),2&r&&(e.R7$(23),e.JRh(o.products.length),e.R7$(8),e.JRh(o.activeProductsCount),e.R7$(8),e.JRh(o.lowStockCount),e.R7$(8),e.JRh(o.outOfStockCount),e.R7$(6),e.Y8G("ngModel",o.searchTerm),e.R7$(3),e.Lme("Showing ",o.filteredProducts.length," of ",o.products.length," products"),e.R7$(1),e.Y8G("ngIf",o.isLoading),e.R7$(1),e.Y8G("ngIf",!o.isLoading),e.R7$(1),e.Y8G("isOpen",o.isModalOpen)("mode",o.modalMode)("entityType","product")("product",o.selectedProduct))},dependencies:[a.YU,a.Sq,a.bT,d.me,d.BC,d.vS,p.Wk,h.n]})}}return i})();var b=u(9003);function j(i,l){1&i&&(e.j41(0,"span"),e.EFF(1,"Product name is required"),e.k0s())}function I(i,l){1&i&&(e.j41(0,"span"),e.EFF(1,"Product name must be at least 3 characters"),e.k0s())}function P(i,l){if(1&i&&(e.j41(0,"div",52),e.DNE(1,j,2,0,"span",51),e.DNE(2,I,2,0,"span",51),e.k0s()),2&i){const t=e.XpG();e.R7$(1),e.Y8G("ngIf",null==t.name||null==t.name.errors?null:t.name.errors.required),e.R7$(1),e.Y8G("ngIf",null==t.name||null==t.name.errors?null:t.name.errors.minlength)}}const E=function(i,l){return{"ring-2 ring-blue-600 bg-blue-100":i,"ring-1 ring-gray-300":l}};function w(i,l){if(1&i){const t=e.RV6();e.j41(0,"button",53),e.bIt("click",function(){const s=e.eBV(t).$implicit,n=e.XpG();return e.Njj(n.toggleColor(s.id))}),e.EFF(1),e.k0s()}if(2&i){const t=l.$implicit,r=e.XpG();e.Y8G("ngClass",e.l_i(2,E,r.selectedColorIds.includes(t.id),!r.selectedColorIds.includes(t.id))),e.R7$(1),e.SpI(" ",t.name," ")}}function A(i,l){1&i&&(e.j41(0,"div",52),e.EFF(1," Colors are required "),e.k0s())}function S(i,l){1&i&&(e.j41(0,"span"),e.EFF(1,"Price is required"),e.k0s())}function M(i,l){1&i&&(e.j41(0,"span"),e.EFF(1,"Price must be greater than 0"),e.k0s())}function R(i,l){if(1&i&&(e.j41(0,"div",52),e.DNE(1,S,2,0,"span",51),e.DNE(2,M,2,0,"span",51),e.k0s()),2&i){const t=e.XpG();e.R7$(1),e.Y8G("ngIf",null==t.price||null==t.price.errors?null:t.price.errors.required),e.R7$(1),e.Y8G("ngIf",null==t.price||null==t.price.errors?null:t.price.errors.min)}}function $(i,l){1&i&&(e.j41(0,"span"),e.EFF(1,"Stock quantity is required"),e.k0s())}function T(i,l){1&i&&(e.j41(0,"span"),e.EFF(1,"Stock must be 0 or greater"),e.k0s())}function O(i,l){if(1&i&&(e.j41(0,"div",52),e.DNE(1,$,2,0,"span",51),e.DNE(2,T,2,0,"span",51),e.k0s()),2&i){const t=e.XpG();e.R7$(1),e.Y8G("ngIf",null==t.currentStock||null==t.currentStock.errors?null:t.currentStock.errors.required),e.R7$(1),e.Y8G("ngIf",null==t.currentStock||null==t.currentStock.errors?null:t.currentStock.errors.min)}}function G(i,l){if(1&i&&(e.j41(0,"option",54),e.EFF(1),e.k0s()),2&i){const t=l.$implicit;e.Y8G("value",t.id),e.R7$(1),e.SpI(" ",t.name," ")}}function N(i,l){1&i&&(e.j41(0,"div",52),e.EFF(1," Category is required "),e.k0s())}function U(i,l){1&i&&(e.j41(0,"div",64)(1,"span",65),e.EFF(2,"Invalid URL"),e.k0s()())}function D(i,l){if(1&i){const t=e.RV6();e.j41(0,"div",59)(1,"img",60),e.bIt("error",function(){const s=e.eBV(t).index,n=e.XpG(2);return e.Njj(n.markImageAsInvalid(s))}),e.k0s(),e.j41(2,"div",61),e.EFF(3),e.k0s(),e.j41(4,"button",62),e.bIt("click",function(){const s=e.eBV(t).index,n=e.XpG(2);return e.Njj(n.removeImage(s))}),e.EFF(5," \xd7 "),e.k0s(),e.DNE(6,U,3,0,"div",63),e.k0s()}if(2&i){const t=l.$implicit,r=l.index,o=e.XpG(2);e.R7$(1),e.HbH(o.isImageUrlInvalid(r)?"opacity-50":""),e.Y8G("src",t,e.B4B),e.R7$(1),e.Y8G("title",o.getImageSourceType(t)),e.R7$(1),e.SpI(" ",o.getImageSourceType(t)," "),e.R7$(3),e.Y8G("ngIf",o.isImageUrlInvalid(r))}}function Y(i,l){if(1&i){const t=e.RV6();e.j41(0,"div",66)(1,"button",67),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.clearAllImages())}),e.EFF(2," Clear All Images "),e.k0s(),e.j41(3,"button",68),e.bIt("click",function(){e.eBV(t);const o=e.XpG(2);return e.Njj(o.reorderImages())}),e.EFF(4," Reorder Randomly "),e.k0s()()}}function X(i,l){if(1&i&&(e.j41(0,"div",15)(1,"h3",55),e.EFF(2),e.k0s(),e.j41(3,"div",56),e.DNE(4,D,7,6,"div",57),e.k0s(),e.DNE(5,Y,5,0,"div",58),e.k0s()),2&i){const t=e.XpG();e.R7$(2),e.SpI("Selected Images (",t.imagePreviews.length,")"),e.R7$(2),e.Y8G("ngForOf",t.imagePreviews),e.R7$(1),e.Y8G("ngIf",t.imagePreviews.length>0)}}function B(i,l){if(1&i&&(e.j41(0,"span"),e.nrm(1,"i",69),e.EFF(2),e.k0s()),2&i){const t=e.XpG();e.R7$(2),e.SpI(" ",t.isEditMode?"Updating...":"Creating..."," ")}}function V(i,l){if(1&i&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&i){const t=e.XpG();e.R7$(1),e.SpI(" ",t.isEditMode?"Update Product":"Create Product"," ")}}let v=(()=>{class i{constructor(t,r,o,s,n,c){this.fb=t,this.route=r,this.router=o,this.productService=s,this.categoriesService=n,this.toast=c,this.categories=[],this.colors=[],this.selectedColorIds=[],this.isEditMode=!1,this.isSubmitting=!1,this.imagePreviews=[],this.invalidImageUrls=[],this.uploadedFiles=[],this.imageUrls=[]}ngOnInit(){this.productForm=this.createProductForm(),this.loadCategories(),this.loadColors()}createProductForm(){return this.fb.group({name:["",[d.k0.required,d.k0.minLength(3)]],description:[""],price:[0,[d.k0.required,d.k0.min(0)]],currentStock:[0,[d.k0.required,d.k0.min(0)]],category:["",d.k0.required],status:["active"],topSelling:["no"],colors:[[],d.k0.required],warranty:[""]})}loadCategories(){this.categoriesService.getCategories().subscribe({next:t=>this.categories=t.filter(r=>!0===r.isActive),error:()=>this.toast.error("Failed to load categories")})}loadColors(){this.productService.getAllColors().subscribe({next:t=>{this.colors=t.data.filter(r=>!0===r.isActive)},error:()=>this.toast.error("Failed to load colors")})}toggleColor(t){this.selectedColorIds.includes(t)?this.selectedColorIds=this.selectedColorIds.filter(r=>r!==t):this.selectedColorIds.push(t),this.productForm.patchValue({colors:this.selectedColorIds})}onImageSelected(t){const r=t.target.files;if(r&&0!==r.length){for(let o of Array.from(r)){if(!o.type.startsWith("image/")){this.toast.error(`${o.name} is not a valid image file`);continue}if(o.size>10485760){this.toast.error(`${o.name} exceeds 10MB limit`);continue}this.uploadedFiles.push(o);const s=new FileReader;s.onload=n=>{this.imagePreviews.push(n.target.result)},s.readAsDataURL(o)}t.target.value=""}}removeImage(t){const r=this.imagePreviews[t];if(r.startsWith("data:")){const s=this.imagePreviews.slice(0,t).filter(n=>n.startsWith("data:")).length;this.uploadedFiles.splice(s,1)}else{const s=this.imageUrls.indexOf(r);s>-1&&this.imageUrls.splice(s,1)}this.imagePreviews.splice(t,1);const o=this.invalidImageUrls.indexOf(t);o>-1&&this.invalidImageUrls.splice(o,1),this.invalidImageUrls=this.invalidImageUrls.map(s=>s>t?s-1:s)}clearAllImages(){this.imagePreviews=[],this.uploadedFiles=[],this.imageUrls=[],this.invalidImageUrls=[]}reorderImages(){const t=this.imagePreviews.map((s,n)=>({preview:s,sort:Math.random(),oldIndex:n}));t.sort((s,n)=>s.sort-n.sort),this.imagePreviews=t.map(s=>s.preview);const r=[],o=[];for(const s of t)if(s.preview.startsWith("data:")){const n=this.imagePreviews.slice(0,s.oldIndex).filter(c=>c.startsWith("data:")).length;r.push(this.uploadedFiles[n])}else o.push(s.preview);this.uploadedFiles=r,this.imageUrls=o,this.invalidImageUrls=[]}markImageAsInvalid(t){this.invalidImageUrls.includes(t)||this.invalidImageUrls.push(t)}isImageUrlInvalid(t){return this.invalidImageUrls.includes(t)}getImageSourceType(t){return t.startsWith("data:")?"Uploaded File":t.startsWith("blob:")?"Blob URL":"External URL"}validateImageUrl(t){const r=this.imagePreviews[t];if(r.startsWith("data:")||r.startsWith("blob:"))return;const o=new Image;o.onload=()=>{const s=this.invalidImageUrls.indexOf(t);s>-1&&this.invalidImageUrls.splice(s,1)},o.onerror=()=>this.markImageAsInvalid(t),o.src=r,setTimeout(()=>{o.complete||this.markImageAsInvalid(t)},5e3)}onSubmit(){if(this.productForm.invalid)return void this.productForm.markAllAsTouched();if(0===this.uploadedFiles.length)return void this.toast.error("Please upload at least one product image");this.isSubmitting=!0;const t={...this.productForm.value,categoryId:this.productForm.value.category,isActive:"active"===this.productForm.value.status,status:"active"===this.productForm.value.status,topSelling:"yes"===this.productForm.value.topSelling,colorIds:this.selectedColorIds,files:this.uploadedFiles};this.productService.createProduct(t).subscribe({next:()=>{this.toast.success("Product Created Successfully"),this.router.navigate(["/admin/products/list"]),this.isSubmitting=!1},error:r=>{let o="Failed to create product";if(r.error?.errors){const s=Object.keys(r.error.errors)[0];o=r.error.errors[s][0]}else r.error?.message?o=r.error.message:r.status&&(o=`Error ${r.status}: ${r.statusText}`);this.toast.error(o),this.isSubmitting=!1}})}get name(){return this.productForm.get("name")}get price(){return this.productForm.get("price")}get currentStock(){return this.productForm.get("currentStock")}get category(){return this.productForm.get("category")}get colorsControl(){return this.productForm.get("colors")}static{this.\u0275fac=function(r){return new(r||i)(e.rXU(d.ok),e.rXU(p.nX),e.rXU(p.Ix),e.rXU(g.b),e.rXU(b.w),e.rXU(m.f))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-admin-product-form"]],decls:112,vars:14,consts:[[1,"p-6"],[1,"mb-6"],[1,"text-2xl","font-bold","text-gray-800"],[1,"text-gray-600","mt-1"],[1,"bg-white","rounded-lg","shadow-md","p-6"],[1,"space-y-6",3,"formGroup","ngSubmit"],[1,"border-b","border-gray-200","pb-6"],[1,"text-lg","font-semibold","text-gray-800","mb-4"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],["for","name",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["type","text","id","name","formControlName","name","placeholder","Enter product name",1,"w-full","px-3","py-2","text-black","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],["class","text-red-500 text-sm mt-1",4,"ngIf"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],[1,"flex","flex-wrap","gap-2"],["type","button","class","px-3 py-1 rounded-lg border text-black",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"mt-4"],["for","description",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["id","description","formControlName","description","rows","4","placeholder","Enter product description",1,"w-full","px-3","py-2","text-black","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-6"],["for","price",1,"block","text-sm","font-medium","text-gray-700","mb-2"],[1,"relative"],[1,"absolute","left-3","top-2","text-gray-500"],["type","number","id","price","formControlName","price","step","0.01","min","0","placeholder","0.00",1,"w-full","pl-8","pr-3","py-2","text-black","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],["for","warranty",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["type","text","id","warranty","formControlName","warranty","placeholder","e.g., 1 Y",1,"w-full","pl-8","pr-3","py-2","text-black","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],["for","currentStock",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["type","number","id","currentStock","formControlName","currentStock","min","0","placeholder","0",1,"w-full","px-3","py-2","border","text-black","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],["for","category",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["id","category","formControlName","category",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500","text-black","focus:border-transparent"],["value","",1,"text-black"],["class","text-black",3,"value",4,"ngFor","ngForOf"],[1,"flex","space-x-4"],[1,"inline-flex","items-center"],["type","radio","formControlName","status","value","active",1,"text-blue-600","focus:ring-blue-500"],[1,"ml-2","text-gray-700"],["type","radio","formControlName","status","value","inactive",1,"text-blue-600","focus:ring-blue-500"],["type","radio","formControlName","topSelling","value","yes",1,"text-blue-600","focus:ring-blue-500"],["type","radio","formControlName","topSelling","value","no",1,"text-blue-600","focus:ring-blue-500"],[1,"text-md","font-medium","text-gray-700","mb-3"],[1,"border-2","border-dashed","border-gray-300","rounded-lg","p-6","text-center"],[1,"fa-solid","fa-cloud-arrow-up","text-3xl","text-gray-400","mb-3"],[1,"text-gray-600","mb-2"],[1,"text-sm","text-gray-500","mb-4"],["type","file","multiple","","accept","image/*",1,"hidden",3,"change"],["fileInput",""],["type","button",1,"bg-blue-600","hover:bg-blue-700","text-white","px-4","py-2","rounded-lg",3,"click"],[1,"text-xs","text-gray-500","mt-2"],["class","mt-4",4,"ngIf"],[1,"flex","justify-end","space-x-4","pt-4"],["type","button","routerLink","/admin/products/list",1,"px-6","py-2","border","border-gray-300","text-gray-700","rounded-lg","hover:bg-gray-50","transition-colors"],["type","submit",1,"px-6","py-2","bg-blue-600","text-white","rounded-lg","hover:bg-blue-700","disabled:bg-blue-300","disabled:cursor-not-allowed","transition-colors",3,"disabled"],[4,"ngIf"],[1,"text-red-500","text-sm","mt-1"],["type","button",1,"px-3","py-1","rounded-lg","border","text-black",3,"ngClass","click"],[1,"text-black",3,"value"],[1,"text-sm","font-medium","text-gray-700","mb-2"],[1,"grid","grid-cols-2","md:grid-cols-4","lg:grid-cols-6","gap-4"],["class","relative border rounded-lg overflow-hidden bg-gray-100",4,"ngFor","ngForOf"],["class","mt-4 flex space-x-2",4,"ngIf"],[1,"relative","border","rounded-lg","overflow-hidden","bg-gray-100"],["alt","Preview",1,"w-full","h-24","object-cover",3,"src","error"],[1,"p-2","text-xs","truncate",3,"title"],["type","button",1,"absolute","top-1","right-1","bg-red-500","text-white","rounded-full","w-5","h-5","flex","items-center","justify-center","text-xs","hover:bg-red-600","transition-colors",3,"click"],["class","absolute inset-0 bg-red-100 bg-opacity-50 flex items-center justify-center",4,"ngIf"],[1,"absolute","inset-0","bg-red-100","bg-opacity-50","flex","items-center","justify-center"],[1,"text-red-600","text-xs","font-medium"],[1,"mt-4","flex","space-x-2"],["type","button",1,"px-3","py-1","bg-red-500","text-white","text-sm","rounded","hover:bg-red-600","transition-colors",3,"click"],["type","button",1,"px-3","py-1","bg-gray-500","text-white","text-sm","rounded","hover:bg-gray-600","transition-colors",3,"click"],[1,"fa-solid","fa-spinner","fa-spin","mr-2"]],template:function(r,o){if(1&r){const s=e.RV6();e.j41(0,"div",0)(1,"div",1)(2,"h1",2),e.EFF(3),e.k0s(),e.j41(4,"p",3),e.EFF(5),e.k0s()(),e.j41(6,"div",4)(7,"form",5),e.bIt("ngSubmit",function(){return o.onSubmit()}),e.j41(8,"div",6)(9,"h2",7),e.EFF(10,"Basic Information"),e.k0s(),e.j41(11,"div",8)(12,"div")(13,"label",9),e.EFF(14," Product Name * "),e.k0s(),e.nrm(15,"input",10),e.DNE(16,P,3,2,"div",11),e.k0s(),e.j41(17,"div")(18,"label",12),e.EFF(19," Colors Available * "),e.k0s(),e.j41(20,"div",13),e.DNE(21,w,2,5,"button",14),e.k0s(),e.DNE(22,A,2,0,"div",11),e.k0s()(),e.j41(23,"div",15)(24,"label",16),e.EFF(25," Description "),e.k0s(),e.nrm(26,"textarea",17),e.k0s()(),e.j41(27,"div",6)(28,"h2",7),e.EFF(29,"Pricing & Inventory"),e.k0s(),e.j41(30,"div",18)(31,"div")(32,"label",19),e.EFF(33," Price * "),e.k0s(),e.j41(34,"div",20)(35,"span",21),e.EFF(36,"$"),e.k0s(),e.nrm(37,"input",22),e.k0s(),e.DNE(38,R,3,2,"div",11),e.k0s(),e.j41(39,"div")(40,"label",23),e.EFF(41," Warranty "),e.k0s(),e.j41(42,"div",20)(43,"span",21),e.EFF(44,"Y"),e.k0s(),e.nrm(45,"input",24),e.k0s()(),e.j41(46,"div")(47,"label",25),e.EFF(48," Stock Quantity * "),e.k0s(),e.nrm(49,"input",26),e.DNE(50,O,3,2,"div",11),e.k0s()()(),e.j41(51,"div",6)(52,"h2",7),e.EFF(53,"Categories & Status"),e.k0s(),e.j41(54,"div",8)(55,"div")(56,"label",27),e.EFF(57," Category * "),e.k0s(),e.j41(58,"select",28)(59,"option",29),e.EFF(60,"Select Category"),e.k0s(),e.DNE(61,G,2,2,"option",30),e.k0s(),e.DNE(62,N,2,0,"div",11),e.k0s(),e.j41(63,"div")(64,"label",12),e.EFF(65,"Status"),e.k0s(),e.j41(66,"div",31)(67,"label",32),e.nrm(68,"input",33),e.j41(69,"span",34),e.EFF(70,"Active"),e.k0s()(),e.j41(71,"label",32),e.nrm(72,"input",35),e.j41(73,"span",34),e.EFF(74,"Inactive"),e.k0s()()()(),e.j41(75,"div")(76,"label",12),e.EFF(77,"Top Selling"),e.k0s(),e.j41(78,"div",31)(79,"label",32),e.nrm(80,"input",36),e.j41(81,"span",34),e.EFF(82,"Yes"),e.k0s()(),e.j41(83,"label",32),e.nrm(84,"input",37),e.j41(85,"span",34),e.EFF(86,"No"),e.k0s()()()()()(),e.j41(87,"div",6)(88,"h2",7),e.EFF(89,"Product Images"),e.k0s(),e.j41(90,"div",1)(91,"h3",38),e.EFF(92,"Upload Images"),e.k0s(),e.j41(93,"div",39),e.nrm(94,"i",40),e.j41(95,"p",41),e.EFF(96,"Drag & drop your images here"),e.k0s(),e.j41(97,"p",42),e.EFF(98,"or"),e.k0s(),e.j41(99,"input",43,44),e.bIt("change",function(c){return o.onImageSelected(c)}),e.k0s(),e.j41(101,"button",45),e.bIt("click",function(){e.eBV(s);const c=e.sdS(100);return e.Njj(c.click())}),e.EFF(102," Browse Files "),e.k0s(),e.j41(103,"p",46),e.EFF(104,"PNG, JPG, GIF up to 10MB"),e.k0s()()(),e.DNE(105,X,6,3,"div",47),e.k0s(),e.j41(106,"div",48)(107,"button",49),e.EFF(108," Cancel "),e.k0s(),e.j41(109,"button",50),e.DNE(110,B,3,1,"span",51),e.DNE(111,V,2,1,"span",51),e.k0s()()()()()}if(2&r){let s;e.R7$(3),e.SpI(" ",o.isEditMode?"Edit Product":"Add New Product"," "),e.R7$(2),e.SpI(" ",o.isEditMode?"Update existing product information":"Create a new product for your store"," "),e.R7$(2),e.Y8G("formGroup",o.productForm),e.R7$(9),e.Y8G("ngIf",(null==o.name?null:o.name.invalid)&&(null==o.name?null:o.name.touched)),e.R7$(5),e.Y8G("ngForOf",o.colors),e.R7$(1),e.Y8G("ngIf",(null==(s=o.productForm.get("colors"))?null:s.invalid)&&(null==(s=o.productForm.get("colors"))?null:s.touched)),e.R7$(16),e.Y8G("ngIf",(null==o.price?null:o.price.invalid)&&(null==o.price?null:o.price.touched)),e.R7$(12),e.Y8G("ngIf",(null==o.currentStock?null:o.currentStock.invalid)&&(null==o.currentStock?null:o.currentStock.touched)),e.R7$(11),e.Y8G("ngForOf",o.categories),e.R7$(1),e.Y8G("ngIf",(null==o.category?null:o.category.invalid)&&(null==o.category?null:o.category.touched)),e.R7$(43),e.Y8G("ngIf",o.imagePreviews.length>0),e.R7$(4),e.Y8G("disabled",o.productForm.invalid||o.isSubmitting),e.R7$(1),e.Y8G("ngIf",o.isSubmitting),e.R7$(1),e.Y8G("ngIf",!o.isSubmitting)}},dependencies:[a.YU,a.Sq,a.bT,d.qT,d.xH,d.y7,d.me,d.Q0,d.wz,d.Fm,d.BC,d.cb,d.VZ,p.Wk,d.j4,d.JD],styles:['.form-group[_ngcontent-%COMP%]{margin-bottom:1.5rem}.required[_ngcontent-%COMP%]:after{content:" *";color:#ef4444}.image-preview-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1rem;margin-top:1rem}.image-preview[_ngcontent-%COMP%]{position:relative;width:100px;height:100px;border:2px solid #e5e7eb;border-radius:.5rem;overflow:hidden}.image-preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.remove-image[_ngcontent-%COMP%]{position:absolute;top:0;right:0;background:#ef4444;color:#fff;border:none;border-radius:50%;width:20px;height:20px;display:flex;align-items:center;justify-content:center;font-size:.75rem;cursor:pointer}.ng-invalid.ng-touched[_ngcontent-%COMP%]{border-color:#ef4444!important}.validation-error[_ngcontent-%COMP%]{color:#ef4444;font-size:.875rem;margin-top:.25rem}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.animate-spin[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}']})}}return i})();function L(i,l){if(1&i){const t=e.RV6();e.j41(0,"div",36)(1,"button",37),e.bIt("click",function(){e.eBV(t);const o=e.XpG().$implicit,s=e.XpG();return e.Njj(s.openEditCategoryModal(o))}),e.EFF(2," Edit "),e.k0s(),e.j41(3,"button",38),e.bIt("click",function(){e.eBV(t);const o=e.XpG().$implicit,s=e.XpG();return e.Njj(s.openDeleteCategoryModal(o))}),e.EFF(4," Delete "),e.k0s()()}}function W(i,l){if(1&i){const t=e.RV6();e.j41(0,"div",21)(1,"div",22)(2,"div",23)(3,"div")(4,"div",24),e.nrm(5,"i",25),e.k0s(),e.j41(6,"h3",26),e.EFF(7),e.k0s(),e.j41(8,"p",27),e.EFF(9),e.k0s(),e.j41(10,"p",28),e.EFF(11),e.k0s()(),e.j41(12,"span",29),e.EFF(13),e.k0s()(),e.j41(14,"div",30)(15,"button",31),e.bIt("click",function(){const s=e.eBV(t).$implicit,n=e.XpG();return e.Njj(n.toggleStatus(s.id))}),e.EFF(16),e.k0s(),e.j41(17,"div",32)(18,"button",33),e.bIt("click",function(){const s=e.eBV(t).$implicit,n=e.XpG();return e.Njj(n.menuOption(s.id))}),e.nrm(19,"i",34),e.k0s(),e.DNE(20,L,5,0,"div",35),e.k0s()()()()}if(2&i){const t=l.$implicit,r=e.XpG();e.R7$(7),e.SpI(" ",t.name," "),e.R7$(2),e.SpI(" ",t.description||"No description"," "),e.R7$(2),e.SpI(" Products: ",t.productCount," "),e.R7$(1),e.Y8G("ngClass",t.isActive?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),e.R7$(1),e.SpI(" ",t.isActive?"Active":"Inactive"," "),e.R7$(2),e.Y8G("ngClass",t.isActive?"bg-red-100 text-red-600":"bg-green-100 text-green-600"),e.R7$(1),e.SpI(" ",t.isActive?"Deactivate":"Activate"," "),e.R7$(4),e.Y8G("ngIf",r.openMenuId===t.id)}}function J(i,l){if(1&i){const t=e.RV6();e.j41(0,"div",39)(1,"h3",40),e.EFF(2,"No categories"),e.k0s(),e.j41(3,"button",41),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.openAddCategoryModal())}),e.EFF(4," Create "),e.k0s()()}}let q=(()=>{class i{constructor(t,r){this.categoriesService=t,this.toast=r,this.categories=[],this.openMenuId=null,this.totalCategories=0,this.activeCategories=0,this.nonActiveCategories=0,this.isModalOpen=!1,this.modalMode="add",this.selectedCategory=null}ngOnInit(){this.loadCategories()}loadCategories(){this.categoriesService.getCategories().subscribe({next:t=>{this.categories=t,this.totalCategories=this.categories.length,this.activeCategories=this.categories.filter(r=>r.isActive).length,this.nonActiveCategories=this.categories.filter(r=>!r.isActive).length},error:()=>this.toast.error("Failed to load categories")})}menuOption(t){this.openMenuId=this.openMenuId===t?null:t}openAddCategoryModal(){this.modalMode="add",this.selectedCategory=null,this.isModalOpen=!0}openEditCategoryModal(t){this.modalMode="edit",this.selectedCategory={...t},this.isModalOpen=!0,this.openMenuId=null}openDeleteCategoryModal(t){this.modalMode="delete",this.selectedCategory={...t},this.isModalOpen=!0,this.openMenuId=null}closeModal(){this.isModalOpen=!1,this.selectedCategory=null,this.modalMode="add"}handleSave(t){if("add"===this.modalMode)this.categoriesService.addCategory(t).subscribe({next:()=>{this.toast.success("Category created"),this.closeModal(),this.loadCategories()},error:r=>{console.log(r),this.toast.error(r?.error?.message||"Failed to create category")}});else if("edit"===this.modalMode&&this.selectedCategory){const r={id:this.selectedCategory.id,...t};this.categoriesService.updateCategory(r).subscribe({next:()=>{this.toast.success("Category updated"),this.closeModal(),this.loadCategories()},error:()=>this.toast.error("Failed to update category")})}}handleDelete(t){this.categoriesService.deleteCategory(t).subscribe({next:()=>{this.toast.success("Category deleted"),this.closeModal(),this.loadCategories()},error:()=>this.toast.error("Failed to delete category")})}toggleStatus(t){this.categoriesService.toggleStatus(t).subscribe({next:r=>{this.toast.success(r.message),this.loadCategories()},error:()=>this.toast.error("Failed to change status")})}static{this.\u0275fac=function(r){return new(r||i)(e.rXU(b.w),e.rXU(m.f))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-admin-product-categories"]],decls:38,vars:9,consts:[[1,"p-6"],[1,"flex","justify-between","items-center","mb-6"],[1,"text-2xl","font-bold","text-gray-800"],[1,"text-gray-600","mt-1"],[1,"bg-blue-600","hover:bg-blue-700","text-white","px-4","py-2","rounded-lg","flex","items-center","space-x-2",3,"click"],[1,"fa-solid","fa-plus"],[1,"bg-gray-50","rounded-lg","p-6"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],[1,"bg-white","rounded-lg","p-4","text-center","border"],[1,"text-2xl","font-bold","text-blue-600"],[1,"text-sm","text-gray-600"],[1,"text-2xl","font-bold","text-green-600"],[1,"text-2xl","font-bold","text-red-600"],[1,"text-lg","font-semibold","text-gray-800","mt-4","mb-4"],[1,"grid","grid-cols-1","md:grid-cols-3","lg:grid-cols-4","gap-6"],["class","bg-white rounded-xl border shadow hover:shadow-lg transition",4,"ngFor","ngForOf"],[1,"flex","flex-col","items-center","justify-center","border-2","border-dashed","rounded-xl","p-6","cursor-pointer","hover:border-blue-500","hover:bg-blue-50","transition",3,"click"],[1,"fa-solid","fa-plus","text-3xl","text-blue-500","mb-2"],[1,"text-blue-600","font-medium"],["class","text-center py-12",4,"ngIf"],[3,"isOpen","mode","entityType","category","close","save","confirmDelete"],[1,"bg-white","rounded-xl","border","shadow","hover:shadow-lg","transition"],[1,"p-4"],[1,"flex","justify-between","items-start"],[1,"w-10","h-10","rounded-xl","bg-blue","flex","items-center","justify-center","text-gray-600"],[1,"fa-solid","fa-box","text-sm"],[1,"font-semibold","text-gray-800"],[1,"text-sm","text-gray-500"],[1,"text-xs","text-gray-400","mt-1"],[1,"px-2","py-1","text-xs","rounded",3,"ngClass"],[1,"mt-4","flex","justify-between"],[1,"px-3","py-1","rounded","text-sm",3,"ngClass","click"],[1,"relative"],[1,"text-black","p-2","rounded","hover:bg-gray-100",3,"click"],[1,"fa-solid","fa-ellipsis-vertical"],["class","absolute right-0 bg-white rounded shadow border",4,"ngIf"],[1,"absolute","right-0","bg-white","rounded","shadow","border"],[1,"text-black","block","w-full","px-4","py-2","text-sm","hover:bg-gray-100",3,"click"],[1,"block","w-full","px-4","py-2","text-sm","text-red-600","hover:bg-gray-100",3,"click"],[1,"text-center","py-12"],[1,"text-lg","font-medium","text-gray-700","mb-2"],[1,"bg-blue-600","text-white","px-5","py-2","rounded",3,"click"]],template:function(r,o){1&r&&(e.j41(0,"div",0)(1,"div",1)(2,"div")(3,"h1",2),e.EFF(4,"Product Categories"),e.k0s(),e.j41(5,"p",3),e.EFF(6," Manage product categories "),e.k0s()(),e.j41(7,"button",4),e.bIt("click",function(){return o.openAddCategoryModal()}),e.nrm(8,"i",5),e.j41(9,"span"),e.EFF(10,"Add Category"),e.k0s()()(),e.j41(11,"div",6)(12,"div",7)(13,"div",8)(14,"div",9),e.EFF(15),e.k0s(),e.j41(16,"div",10),e.EFF(17,"Total"),e.k0s()(),e.j41(18,"div",8)(19,"div",11),e.EFF(20),e.k0s(),e.j41(21,"div",10),e.EFF(22,"Active"),e.k0s()(),e.j41(23,"div",8)(24,"div",12),e.EFF(25),e.k0s(),e.j41(26,"div",10),e.EFF(27,"Non Active"),e.k0s()()()(),e.j41(28,"h2",13),e.EFF(29,"Category List"),e.k0s(),e.j41(30,"div",14),e.DNE(31,W,21,8,"div",15),e.j41(32,"div",16),e.bIt("click",function(){return o.openAddCategoryModal()}),e.nrm(33,"i",17),e.j41(34,"p",18),e.EFF(35,"Add Category"),e.k0s()()(),e.DNE(36,J,5,0,"div",19),e.k0s(),e.j41(37,"app-admin-modals",20),e.bIt("close",function(){return o.closeModal()})("save",function(n){return o.handleSave(n)})("confirmDelete",function(n){return o.handleDelete(n)}),e.k0s()),2&r&&(e.R7$(15),e.JRh(o.totalCategories),e.R7$(5),e.JRh(o.activeCategories),e.R7$(5),e.JRh(o.nonActiveCategories),e.R7$(6),e.Y8G("ngForOf",o.categories),e.R7$(5),e.Y8G("ngIf",0===o.categories.length),e.R7$(1),e.Y8G("isOpen",o.isModalOpen)("mode",o.modalMode)("entityType","category")("category",o.selectedCategory))},dependencies:[a.YU,a.Sq,a.bT,h.n],styles:[".category-card[_ngcontent-%COMP%]{transition:all .3s ease}.category-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.status-badge[_ngcontent-%COMP%]{font-size:.75rem;font-weight:500;padding:.25rem .75rem;border-radius:9999px}.menu-button[_ngcontent-%COMP%]{transition:all .2s ease}.menu-button[_ngcontent-%COMP%]:hover{background-color:#f3f4f6}.dropdown-menu[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_dropdownFade .2s ease-out}@keyframes _ngcontent-%COMP%_dropdownFade{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.modal-overlay[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_modalFade .3s ease-out}.modal-content[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_modalSlide .3s ease-out}@keyframes _ngcontent-%COMP%_modalFade{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_modalSlide{0%{opacity:0;transform:translateY(-20px) scale(.95)}to{opacity:1;transform:translateY(0) scale(1)}}input[type=color][_ngcontent-%COMP%]{-webkit-appearance:none;border:none;border-radius:.5rem;cursor:pointer}input[type=color][_ngcontent-%COMP%]::-webkit-color-swatch-wrapper{padding:0;border-radius:.5rem}input[type=color][_ngcontent-%COMP%]::-webkit-color-swatch{border:none;border-radius:.5rem}.empty-state[_ngcontent-%COMP%]{color:#9ca3af}.empty-state[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{opacity:.5}.stat-card[_ngcontent-%COMP%]{transition:transform .2s ease}.stat-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.animate-fade-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .15s ease-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(-5px)}to{opacity:1;transform:translateY(0)}}.line-clamp-2[_ngcontent-%COMP%]{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}"]})}}return i})();var z=u(1626);let H=(()=>{class i{constructor(t){this.http=t,this.baseUrl="https://localhost:7121/api/Colors"}getAll(){return this.http.get(`${this.baseUrl}/GetAll`,{withCredentials:!0})}create(t){return this.http.post(`${this.baseUrl}/Admin/Create`,t,{withCredentials:!0})}update(t){return this.http.put(`${this.baseUrl}/Admin/Update`,t,{withCredentials:!0})}toggle(t){return this.http.patch(`${this.baseUrl}/Admin/toggle/status${t}`,{},{withCredentials:!0})}delete(t){return this.http.delete(`${this.baseUrl}/Admin/Delete${t}`,{withCredentials:!0})}static{this.\u0275fac=function(r){return new(r||i)(e.KVO(z.Qq))}}static{this.\u0275prov=e.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function K(i,l){if(1&i){const t=e.RV6();e.j41(0,"tr",22)(1,"td",23),e.EFF(2),e.k0s(),e.j41(3,"td",24),e.EFF(4),e.k0s(),e.j41(5,"td",25),e.nrm(6,"div",26),e.k0s(),e.j41(7,"td",27),e.EFF(8),e.k0s(),e.j41(9,"td",25)(10,"span",28),e.EFF(11),e.k0s()(),e.j41(12,"td",29)(13,"button",30),e.bIt("click",function(){const s=e.eBV(t).$implicit,n=e.XpG();return e.Njj(n.toggle(s.id))}),e.EFF(14),e.k0s(),e.j41(15,"button",31),e.bIt("click",function(){const s=e.eBV(t).$implicit,n=e.XpG();return e.Njj(n.openEdit(s))}),e.EFF(16," Edit "),e.k0s(),e.j41(17,"button",32),e.bIt("click",function(){const s=e.eBV(t).$implicit,n=e.XpG();return e.Njj(n.openDelete(s))}),e.EFF(18," Delete "),e.k0s()()()}if(2&i){const t=l.$implicit,r=l.index;e.R7$(2),e.JRh(r+1),e.R7$(2),e.SpI(" ",t.name," "),e.R7$(2),e.xc7("background",t.hexCode),e.R7$(2),e.SpI(" ",t.hexCode," "),e.R7$(2),e.Y8G("ngClass",t.isActive?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),e.R7$(1),e.SpI(" ",t.isActive?"Active":"Inactive"," "),e.R7$(2),e.Y8G("ngClass",t.isActive?"bg-red-100 text-red-700 hover:bg-red-200":"bg-green-100 text-green-700 hover:bg-green-200"),e.R7$(1),e.SpI(" ",t.isActive?"Deactivate":"Activate"," ")}}function Q(i,l){if(1&i){const t=e.RV6();e.j41(0,"div",33)(1,"h3",34),e.EFF(2,"No colors found"),e.k0s(),e.j41(3,"button",35),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.openAdd())}),e.EFF(4," Create Color "),e.k0s()()}}let Z=(()=>{class i{constructor(t,r){this.colorService=t,this.toast=r,this.colors=[],this.openMenuId=null,this.isModalOpen=!1,this.modalMode="add",this.totalCategories=0,this.activeCategories=0,this.nonActiveCategories=0}ngOnInit(){this.load()}load(){this.colorService.getAll().subscribe({next:t=>{this.colors=t.data,this.totalCategories=this.colors.length,this.activeCategories=this.colors.filter(r=>r.isActive).length,this.nonActiveCategories=this.colors.filter(r=>!r.isActive).length},error:()=>this.toast.error("Failed to load colors")})}menuOption(t){this.openMenuId=this.openMenuId===t?null:t}openAdd(){this.modalMode="add",this.selectedColor=void 0,this.isModalOpen=!0}openEdit(t){this.modalMode="edit",this.selectedColor=t,this.isModalOpen=!0,this.openMenuId=null}openDelete(t){this.modalMode="delete",this.selectedColor=t,this.isModalOpen=!0,this.openMenuId=null}closeModal(){this.isModalOpen=!1,this.selectedColor=void 0}save(t){"add"===this.modalMode?this.colorService.create(t).subscribe({next:r=>{this.toast.success(r.message),this.closeModal(),this.load()},error:r=>{let o="Failed to create color";if(r.error?.errors){const s=Object.keys(r.error.errors)[0];o=r.error.errors[s][0]}else r.error?.message&&(o=r.error.message);this.toast.error(o)}}):"edit"===this.modalMode&&this.colorService.update({id:this.selectedColor.id,name:t.name,hexCode:t.hexCode,isActive:t.isActive}).subscribe({next:o=>{this.toast.success(o.message||"Color updated successfully"),this.closeModal(),this.load()},error:o=>{this.toast.error(o?.error?.message||"Failed to update color")}})}confirmDelete(t){this.colorService.delete(t).subscribe({next:r=>{this.toast.success(r.message),this.closeModal(),this.load()},error:()=>this.toast.error("Delete failed")})}toggle(t){this.colorService.toggle(t).subscribe({next:r=>{this.toast.success(r.message),this.load()},error:()=>this.toast.error("Failed to change status")})}static{this.\u0275fac=function(r){return new(r||i)(e.rXU(H),e.rXU(m.f))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-admin-colors"]],decls:50,vars:9,consts:[[1,"p-6"],[1,"flex","justify-between","items-center","mb-6"],[1,"text-2xl","font-bold","text-gray-800"],[1,"text-gray-600","mt-1"],[1,"bg-blue-600","hover:bg-blue-700","text-white","px-4","py-2","rounded-lg","flex","items-center","space-x-2",3,"click"],[1,"fa-solid","fa-plus"],[1,"bg-gray-50","rounded-lg","p-6"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],[1,"bg-white","rounded-lg","p-4","text-center","border"],[1,"text-2xl","font-bold","text-blue-600"],[1,"text-sm","text-gray-600"],[1,"text-2xl","font-bold","text-green-600"],[1,"text-2xl","font-bold","text-red-600"],[1,"text-lg","font-semibold","text-gray-800","mt-4","mb-4"],[1,"bg-white","border","rounded-lg","shadow","overflow-hidden"],[1,"w-full","border-collapse"],[1,"bg-gray-100","text-gray-700"],[1,"p-3","text-left","border"],[1,"p-3","text-center","border"],["class","hover:bg-gray-50",4,"ngFor","ngForOf"],["class","text-center py-12",4,"ngIf"],[3,"isOpen","mode","entityType","color","close","save","confirmDelete"],[1,"hover:bg-gray-50"],[1,"p-3","border","text-black"],[1,"p-3","border","font-medium","text-black"],[1,"p-3","border"],[1,"w-10","h-10","rounded","border"],[1,"p-3","border","text-gray-600"],[1,"px-3","py-1","rounded","text-sm",3,"ngClass"],[1,"p-3","border","text-center","space-x-2"],[1,"px-3","py-1","rounded","text-sm",3,"ngClass","click"],[1,"px-3","py-1","bg-blue-100","text-blue-700","rounded","text-sm","hover:bg-blue-200",3,"click"],[1,"px-3","py-1","bg-red-100","text-red-700","rounded","text-sm","hover:bg-red-200",3,"click"],[1,"text-center","py-12"],[1,"text-gray-600"],[1,"bg-blue-600","text-white","px-4","py-2","rounded","mt-2",3,"click"]],template:function(r,o){1&r&&(e.j41(0,"div",0)(1,"div",1)(2,"div")(3,"h1",2),e.EFF(4,"Product Colors"),e.k0s(),e.j41(5,"p",3),e.EFF(6," Manage product colors "),e.k0s()(),e.j41(7,"button",4),e.bIt("click",function(){return o.openAdd()}),e.nrm(8,"i",5),e.j41(9,"span"),e.EFF(10,"Add Color"),e.k0s()()(),e.j41(11,"div",6)(12,"div",7)(13,"div",8)(14,"div",9),e.EFF(15),e.k0s(),e.j41(16,"div",10),e.EFF(17,"Total"),e.k0s()(),e.j41(18,"div",8)(19,"div",11),e.EFF(20),e.k0s(),e.j41(21,"div",10),e.EFF(22,"Active"),e.k0s()(),e.j41(23,"div",8)(24,"div",12),e.EFF(25),e.k0s(),e.j41(26,"div",10),e.EFF(27,"Non Active"),e.k0s()()()(),e.j41(28,"h2",13),e.EFF(29,"Colors List"),e.k0s(),e.j41(30,"div",14)(31,"table",15)(32,"thead",16)(33,"tr")(34,"th",17),e.EFF(35,"#"),e.k0s(),e.j41(36,"th",17),e.EFF(37,"Color Name"),e.k0s(),e.j41(38,"th",17),e.EFF(39,"Preview"),e.k0s(),e.j41(40,"th",17),e.EFF(41,"Hex Code"),e.k0s(),e.j41(42,"th",17),e.EFF(43,"Status"),e.k0s(),e.j41(44,"th",18),e.EFF(45,"Actions"),e.k0s()()(),e.j41(46,"tbody"),e.DNE(47,K,19,9,"tr",19),e.k0s()()(),e.DNE(48,Q,5,0,"div",20),e.j41(49,"app-admin-modals",21),e.bIt("close",function(){return o.closeModal()})("save",function(n){return o.save(n)})("confirmDelete",function(n){return o.confirmDelete(n)}),e.k0s()()),2&r&&(e.R7$(15),e.JRh(o.totalCategories),e.R7$(5),e.JRh(o.activeCategories),e.R7$(5),e.JRh(o.nonActiveCategories),e.R7$(22),e.Y8G("ngForOf",o.colors),e.R7$(1),e.Y8G("ngIf",0===o.colors.length),e.R7$(1),e.Y8G("isOpen",o.isModalOpen)("mode",o.modalMode)("entityType","color")("color",o.selectedColor))},dependencies:[a.YU,a.Sq,a.bT,h.n]})}}return i})();function ee(i,l){if(1&i&&(e.j41(0,"option",17),e.EFF(1),e.k0s()),2&i){const t=l.$implicit;e.Y8G("value",t.id),e.R7$(1),e.SpI(" ",t.name," ")}}function te(i,l){if(1&i){const t=e.RV6();e.j41(0,"div",23),e.nrm(1,"img",24),e.j41(2,"button",25),e.bIt("click",function(){const s=e.eBV(t).index,n=e.XpG(2);return e.Njj(n.removeImage(s))}),e.EFF(3," \xd7 "),e.k0s()()}if(2&i){const t=l.$implicit;e.R7$(1),e.Y8G("src",t,e.B4B)}}function oe(i,l){if(1&i){const t=e.RV6();e.j41(0,"div")(1,"div",18)(2,"h2",19),e.EFF(3),e.k0s(),e.j41(4,"button",20),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.clearAll())}),e.EFF(5," Clear All "),e.k0s()(),e.j41(6,"div",21),e.DNE(7,te,4,1,"div",22),e.k0s()()}if(2&i){const t=e.XpG();e.R7$(3),e.SpI(" Selected Images (",t.previews.length,") "),e.R7$(4),e.Y8G("ngForOf",t.previews)}}function re(i,l){1&i&&(e.j41(0,"span"),e.nrm(1,"i",26),e.EFF(2," Uploading... "),e.k0s())}function ie(i,l){1&i&&(e.j41(0,"span"),e.EFF(1," Upload Images "),e.k0s())}const se=[{path:"",children:[{path:"",redirectTo:"list",pathMatch:"full"},{path:"list",component:y},{path:"new",component:v},{path:"edit/:id",component:v},{path:"images",component:(()=>{class i{constructor(t,r,o,s){this.route=t,this.productService=r,this.toast=o,this.router=s,this.productId=null,this.defaultText="Select Product",this.selectedFiles=[],this.previews=[],this.isSubmitting=!1,this.products=[]}ngOnInit(){this.productId=Number(this.route.snapshot.paramMap.get("id")),this.productService.getAllProducts().subscribe(t=>{this.products=t})}onFileChange(t){const r=t.target.files;if(r&&0!==r.length){for(let o of Array.from(r)){if(!o.type.startsWith("image/")){this.toast.error(`${o.name} is not an image`);continue}if(o.size>10485760){this.toast.error(`${o.name} exceeds 10MB`);continue}this.selectedFiles.push(o);const s=new FileReader;s.onload=n=>this.previews.push(n.target.result),s.readAsDataURL(o)}t.target.value=""}}removeImage(t){this.selectedFiles.splice(t,1),this.previews.splice(t,1)}clearAll(){this.selectedFiles=[],this.previews=[]}submit(){this.productId?0!==this.selectedFiles.length?(this.isSubmitting=!0,this.productService.addImages(this.productId,this.selectedFiles).subscribe({next:t=>{this.toast.success("Images uploaded successfully"),this.router.navigate(["/admin/products/list"]),this.isSubmitting=!1},error:t=>{this.toast.error(t.error?.message||"Upload failed"),this.isSubmitting=!1}})):this.toast.error("Select at least one image"):this.toast.error("Select product first")}static{this.\u0275fac=function(r){return new(r||i)(e.rXU(p.nX),e.rXU(g.b),e.rXU(m.f),e.rXU(p.Ix))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-admin-product-image-upload"]],decls:27,vars:7,consts:[[1,"p-6"],[1,"text-2xl","font-bold","text-gray-800","mb-2"],[1,"text-gray-600","mb-6","mt-2"],[1,"border","px-3","py-2","rounded","text-black",3,"ngModel","ngModelChange"],["class","text-black",3,"value",4,"ngFor","ngForOf"],[1,"bg-white","p-6","rounded-lg","shadow"],[1,"border-2","border-dashed","border-gray-300","rounded-lg","p-6","text-center","mb-6"],[1,"fa-solid","fa-cloud-arrow-up","text-3xl","text-gray-400","mb-3"],[1,"text-gray-600","mb-2"],["type","file","multiple","","accept","image/*",1,"hidden",3,"change"],["fileInput",""],["type","button",1,"bg-blue-600","hover:bg-blue-700","text-white","px-4","py-2","rounded",3,"click"],[1,"text-xs","text-gray-500","mt-2"],[4,"ngIf"],[1,"flex","justify-end","mt-6","space-x-3"],["routerLink","/admin/products/list",1,"px-5","py-2","border","border-gray-300","rounded","text-black"],[1,"px-6","py-2","bg-blue-600","text-white","rounded","disabled:bg-blue-300",3,"disabled","click"],[1,"text-black",3,"value"],[1,"flex","justify-between","items-center","mb-3"],[1,"font-semibold","text-gray-700"],[1,"px-3","py-1","bg-red-500","text-white","rounded","text-sm",3,"click"],[1,"grid","grid-cols-2","md:grid-cols-4","lg:grid-cols-6","gap-4"],["class","relative border rounded overflow-hidden bg-gray-100",4,"ngFor","ngForOf"],[1,"relative","border","rounded","overflow-hidden","bg-gray-100"],[1,"w-full","h-24","object-cover",3,"src"],[1,"absolute","top-1","right-1","bg-red-600","text-white","rounded-full","w-6","h-6","flex","justify-center","items-center","text-xs",3,"click"],[1,"fa-solid","fa-spinner","fa-spin","mr-2"]],template:function(r,o){if(1&r){const s=e.RV6();e.j41(0,"div",0)(1,"h1",1),e.EFF(2),e.k0s(),e.j41(3,"p",2),e.EFF(4," Select the product : "),e.j41(5,"select",3),e.bIt("ngModelChange",function(c){return o.productId=c}),e.DNE(6,ee,2,2,"option",4),e.k0s()(),e.j41(7,"p",2),e.EFF(8," Upload one or more images for this product - below. "),e.k0s(),e.j41(9,"div",5)(10,"div",6),e.nrm(11,"i",7),e.j41(12,"p",8),e.EFF(13,"Drag & drop or browse images"),e.k0s(),e.j41(14,"input",9,10),e.bIt("change",function(c){return o.onFileChange(c)}),e.k0s(),e.j41(16,"button",11),e.bIt("click",function(){e.eBV(s);const c=e.sdS(15);return e.Njj(c.click())}),e.EFF(17," Browse Files "),e.k0s(),e.j41(18,"p",12),e.EFF(19," JPG | PNG | WEBP | Max 10MB each "),e.k0s()(),e.DNE(20,oe,8,2,"div",13),e.j41(21,"div",14)(22,"button",15),e.EFF(23," Cancel "),e.k0s(),e.j41(24,"button",16),e.bIt("click",function(){return o.submit()}),e.DNE(25,re,3,0,"span",13),e.DNE(26,ie,2,0,"span",13),e.k0s()()()()}2&r&&(e.R7$(2),e.SpI(" Add Images to Product (ID: ",o.productId,") "),e.R7$(3),e.Y8G("ngModel",o.productId),e.R7$(1),e.Y8G("ngForOf",o.products),e.R7$(14),e.Y8G("ngIf",o.previews.length>0),e.R7$(4),e.Y8G("disabled",o.isSubmitting),e.R7$(1),e.Y8G("ngIf",o.isSubmitting),e.R7$(1),e.Y8G("ngIf",!o.isSubmitting))},dependencies:[a.Sq,a.bT,d.xH,d.y7,d.wz,d.BC,d.vS,p.Wk]})}}return i})()},{path:"categories",component:q},{path:"colors",component:Z}]}];let ne=(()=>{class i{static{this.\u0275fac=function(r){return new(r||i)}}static{this.\u0275mod=e.$C({type:i})}static{this.\u0275inj=e.G2t({imports:[p.iI.forChild(se),p.iI]})}}return i})();var le=u(3887);let de=(()=>{class i{static{this.\u0275fac=function(r){return new(r||i)}}static{this.\u0275mod=e.$C({type:i})}static{this.\u0275inj=e.G2t({imports:[a.MD,d.YN,p.iI,d.X1,ne,d.X1,le.G]})}}return i})()}}]);